Traceback (most recent call last):
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/johnmyers/miniconda3/envs/python-2023-12/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# define link function at Y
def mu_link(parameters, x):
    beta0 = parameters['beta0']
    beta = parameters['beta']
    return beta0 + beta * x

# define target function h for MSE
def g(parameters, x, y):
    mu = mu_link(parameters, x)
    return (y - mu) ** 2

# initialize parameters
beta0 = torch.tensor([1.])
beta = torch.tensor([1.])
theta0 = {'beta0': beta0, 'beta': beta}

# define SGD parameters
alpha = 0.1
N = 5
k = 512

# run SGD
sgd_output = SGD(g=g, init_parameters=theta0, X=X, y=y, lr=alpha, batch_size=k, num_epochs=N, random_state=42)

# plot SGD output
plot_sgd(sgd_output,
         ylabel='mean squared error (MSE)',
         plot_title_string='SGD for linear regression',
         h=3,
         per_step_label='MSE per step',
         per_epoch_label='mean MSE per epoch',
         per_epoch_color=magenta,
         legend=True,
         per_step_alpha=0.4)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[3], line 23[0m
[1;32m     20[0m k [38;5;241m=[39m [38;5;241m512[39m
[1;32m     22[0m [38;5;66;03m# run SGD[39;00m
[0;32m---> 23[0m sgd_output [38;5;241m=[39m [43mSGD[49m[43m([49m[43mg[49m[38;5;241;43m=[39;49m[43mg[49m[43m,[49m[43m [49m[43minit_parameters[49m[38;5;241;43m=[39;49m[43mtheta0[49m[43m,[49m[43m [49m[43mX[49m[38;5;241;43m=[39;49m[43mX[49m[43m,[49m[43m [49m[43my[49m[38;5;241;43m=[39;49m[43my[49m[43m,[49m[43m [49m[43mlr[49m[38;5;241;43m=[39;49m[43malpha[49m[43m,[49m[43m [49m[43mbatch_size[49m[38;5;241;43m=[39;49m[43mk[49m[43m,[49m[43m [49m[43mnum_epochs[49m[38;5;241;43m=[39;49m[43mN[49m[43m,[49m[43m [49m[43mrandom_state[49m[38;5;241;43m=[39;49m[38;5;241;43m42[39;49m[43m)[49m
[1;32m     25[0m [38;5;66;03m# plot SGD output[39;00m
[1;32m     26[0m plot_sgd(sgd_output,
[1;32m     27[0m          ylabel[38;5;241m=[39m[38;5;124m'[39m[38;5;124mmean squared error (MSE)[39m[38;5;124m'[39m,
[1;32m     28[0m          plot_title_string[38;5;241m=[39m[38;5;124m'[39m[38;5;124mSGD for linear regression[39m[38;5;124m'[39m,
[0;32m   (...)[0m
[1;32m     33[0m          legend[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m     34[0m          per_step_alpha[38;5;241m=[39m[38;5;241m0.4[39m)

[0;31mTypeError[0m: SGD() got an unexpected keyword argument 'g'

